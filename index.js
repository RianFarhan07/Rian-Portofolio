// Project Database
const projectsDatabase = [
  {
    id: 1,
    title: "Kelompro App",
    description:
      "Aplikasi manajemen kerja kelompok berbasis Android yang dirancang untuk mempermudah kolaborasi tim dalam proyek akademik dan profesional. Menggunakan Kotlin dan Firebase untuk real-time collaboration, fitur chat, pengingat tugas, serta sistem pembagian tugas otomatis.",
    category: "android",
    image: "images/kelompro.png",
    images: [
      "images/KelomproApp/6.png",
      "images/KelomproApp/1.png",
      "images/KelomproApp/2.png",
      "images/KelomproApp/3.png",
      "images/KelomproApp/4.png",
      "images/KelomproApp/5.png",
      "images/KelomproApp/7.png",
      "images/KelomproApp/8.png",
      "images/KelomproApp/9.png",
      "images/KelomproApp/10.png",
      "images/KelomproApp/11.png",
      "images/KelomproApp/12.png",
      "images/KelomproApp/13.png",
      "images/KelomproApp/14.png",
      "images/KelomproApp/15.png",
      "images/KelomproApp/16.png",
      "images/KelomproApp/17.png",
      "images/KelomproApp/18.png",
      "images/KelomproApp/19.png",
      "images/KelomproApp/20.png",
      "images/KelomproApp/21.png",
      "images/KelomproApp/22.png",
      "images/KelomproApp/23.png",
      "images/KelomproApp/24.png",
      "images/KelomproApp/25.png",
      "images/KelomproApp/26.png",
      "images/KelomproApp/27.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 2,
    title: "Mobile Learning",
    description:
      "Aplikasi pembelajaran berbasis mobile yang dikembangkan untuk SMAN 4 Jeneponto. Memiliki fitur materi interaktif, kuis adaptif, dan sistem manajemen kelas berbasis cloud dengan Firebase untuk memfasilitasi pengalaman belajar digital yang lebih fleksibel dan efektif.",
    category: "android",
    image: "images/MobileLearning.png",
    images: [
      "images/MobileLearning/4.png",
      "images/MobileLearning/1.png",
      "images/MobileLearning/2.png",
      "images/MobileLearning/3.png",
      "images/MobileLearning/5.png",
      "images/MobileLearning/6.png",
      "images/MobileLearning/7.png",
      "images/MobileLearning/8.png",
      "images/MobileLearning/9.png",
      "images/MobileLearning/10.png",
      "images/MobileLearning/11.png",
      "images/MobileLearning/12.png",
      "images/MobileLearning/13.png",
      "images/MobileLearning/14.png",
      "images/MobileLearning/15.png",
      "images/MobileLearning/16.png",
      "images/MobileLearning/17.png",
      "images/MobileLearning/18.png",
      "images/MobileLearning/19.png",
      "images/MobileLearning/20.png",
      "images/MobileLearning/21.png",
      "images/MobileLearning/22.png",
      "images/MobileLearning/23.png",
      "images/MobileLearning/24.png",
      "images/MobileLearning/25.png",
      "images/MobileLearning/26.png",
      "images/MobileLearning/27.png",
      "images/MobileLearning/28.png",
      "images/MobileLearning/29.png",
      "images/MobileLearning/30.png",
      "images/MobileLearning/31.png",
      "images/MobileLearning/32.png",
      "images/MobileLearning/33.png",
      "images/MobileLearning/34.png",
      "images/MobileLearning/35.png",
      "images/MobileLearning/36.png",
      "images/MobileLearning/37.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 3,
    title: "Kost Hunt",
    description:
      "Platform pencarian dan pemasangan iklan kost berbasis Android dengan fitur pencarian lokasi berbasis GPS, sistem filter cerdas berdasarkan harga, fasilitas, dan tipe kamar.",
    category: "android",
    image: "images/kostHunt.png",
    images: [
      "images/kostHuntv2/1.png",
      "images/kostHuntv2/2.png",
      "images/kostHuntv2/3.png",
      "images/kostHuntv2/4.png",
      "images/kostHuntv2/5.png",
      "images/kostHuntv2/6.png",
      "images/kostHuntv2/7.png",
      "images/kostHuntv2/8.png",
      "images/kostHuntv2/9.png",
      "images/kostHuntv2/10.png",
      "images/kostHuntv2/11.png",
      "images/kostHuntv2/12.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 4,
    title: "Quiz App",
    description:
      "Aplikasi kuis edukatif berbasis Android yang dirancang untuk membantu pengguna belajar dengan cara yang menyenangkan. Memiliki fitur pertanyaan adaptif berdasarkan tingkat kesulitan, leaderboard global, serta integrasi dengan Firebase untuk penyimpanan data pengguna.",
    category: "android",
    image: "images/kuisApp.png",
    images: [
      "images/quizApp/1.png",
      "images/quizApp/2.png",
      "images/quizApp/3.png",
      "images/quizApp/4.png",
    ],

    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 5,
    title: "ProjeManaj",
    description:
      "Aplikasi manajemen proyek yang terinspirasi dari Trello, dirancang untuk membantu tim dalam mengorganisir tugas dan kolaborasi proyek dengan lebih efisien. reminder otomatis, serta notifikasi real-time berbasis Firebase.",
    category: "android",
    image: "images/ProjeManaj.png",
    images: [
      "images/projeManaj/6.png",
      "images/projeManaj/1.png",
      "images/projeManaj/2.png",
      "images/projeManaj/3.png",
      "images/projeManaj/4.png",
      "images/projeManaj/5.png",
      "images/projeManaj/7.png",
      "images/projeManaj/8.png",
      "images/projeManaj/9.png",
      "images/projeManaj/10.png",
      "images/projeManaj/11.png",
      "images/projeManaj/12.png",
      "images/projeManaj/13.png",
      "images/projeManaj/14.png",
      "images/projeManaj/15.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 6,
    title: "Buku Tamu Disnaker",
    description:
      "Aplikasi pencatatan tamu digital untuk Dinas Ketenagakerjaan Kota Makassar yang menggantikan sistem buku tamu manual dengan teknologi digital. dan penyimpanan data cloud untuk analisis kehadiran.",
    category: "android",
    image: "images/buku-tamu-disnaker.png",
    images: [
      "images/bukuTamuDisnaker/2.png",
      "images/bukuTamuDisnaker/1.png",
      "images/bukuTamuDisnaker/3.png",
      "images/bukuTamuDisnaker/4.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 7,
    title: "ShopeeKWApp",
    description:
      "Marketplace online berbasis Android yang mengadopsi konsep e-commerce seperti Shopee, dengan fitur katalog produk, sistem checkout, metode pembayaran digital, serta integrasi Firebase untuk sistem login dan database pengguna.",
    category: "android",
    image: "images/ShopeeKW.png",
    images: [
      "images/ShopeeKWApp/5.png",
      "images/ShopeeKWApp/1.png",
      "images/ShopeeKWApp/2.png",
      "images/ShopeeKWApp/3.png",
      "images/ShopeeKWApp/4.png",
      "images/ShopeeKWApp/6.png",
      "images/ShopeeKWApp/7.png",
      "images/ShopeeKWApp/8.png",
      "images/ShopeeKWApp/9.png",
      "images/ShopeeKWApp/10.png",
      "images/ShopeeKWApp/11.png",
      "images/ShopeeKWApp/12.png",
      "images/ShopeeKWApp/13.png",
      "images/ShopeeKWApp/14.png",
      "images/ShopeeKWApp/15.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 8,
    title: "PortoRian",
    description:
      "Website portofolio interaktif yang menampilkan proyek-proyek pengembangan software, dibangun dengan HTML, Bootstrap, dan JavaScript untuk tampilan responsif dan navigasi yang intuitif.",
    category: "web",
    image: "images/ss1.png",
    techLogos: ["svg/html.svg", "svg/bootstrap.svg", "svg/javascript.svg"],
  },
  {
    id: 9,
    title: "WhatShouldICookToday",
    description:
      "Website rekomendasi resep masakan berdasarkan bahan yang tersedia di dapur pengguna. Menggunakan API eksternal untuk menampilkan resep acak setiap harinya, serta backend berbasis Express.js untuk mengelola pencarian dan rekomendasi.",
    category: "web",
    image: "images/cook.png",
    techLogos: [
      "svg/html.svg",
      "svg/css1.svg",
      "svg/javascript.svg",
      "svg/express-js.svg",
    ],
    github: "https://github.com/rian-surya/WhatShouldICookToday",
  },
  {
    id: 10,
    title: "BookReview",
    description:
      "Platform review buku berbasis web yang memungkinkan pengguna untuk memberikan rating dan ulasan terhadap buku yang telah dibaca. Memiliki sistem pencarian berbasis Open Library API.",
    category: "web",
    image: "images/book.png",
    techLogos: [
      "svg/html.svg",
      "svg/css.svg",
      "svg/javascript.svg",
      "svg/express-js.svg",
      "svg/node-js.svg",
    ],
  },
  {
    id: 11,
    title: "IndonesiaTravelWeb",
    description:
      "Website interaktif untuk menandai kota-kota yang telah dikunjungi di Indonesia. Menggunakan peta dinamis , serta fitur rekomendasi destinasi berdasarkan preferensi pengguna.",
    category: "web",
    image: "images/indonesia.png",
    techLogos: [
      "svg/html.svg",
      "svg/css1.svg",
      "svg/javascript.svg",
      "svg/express-js.svg",
      "svg/node-js.svg",
    ],
  },
  {
    id: 12,
    title: "RylixHub App",
    description:
      "Aplikasi berbagi foto dan video tempat-tempat indah di seluruh dunia. penyimpanan cloud menggunakan Firebase Storage.",
    category: "android",
    image: "images/RylixHub.png",
    images: [
      "images/RylixHub.png",
      "images/rylixHub/1.png",
      "images/rylixHub/2.png",
      "images/rylixHub/3.png",
      "images/rylixHub/4.png",
      "images/rylixHub/5.png",
      "images/rylixHub/6.png",
      "images/rylixHub/7.png",
      "images/rylixHub/8.png",
      "images/rylixHub/9.png",
      "images/rylixHub/10.png",
      "images/rylixHub/11.png",
      "images/rylixHub/12.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 13,
    title: "Ngobrol App",
    description:
      "Aplikasi chatting real-time yang memungkinkan pengguna berinteraksi dengan orang baru. Menggunakan Firebase Firestore untuk sistem pesan instan.",
    category: "android",
    image: "images/ngobrolApp.png",
    images: [
      "images/ngobrolApp.png",
      "images/NgobrolApp/1.png",
      "images/NgobrolApp/2.png",
      "images/NgobrolApp/3.png",
      "images/NgobrolApp/4.png",
      "images/NgobrolApp/5.png",
      "images/NgobrolApp/6.png",
      "images/NgobrolApp/7.png",
      "images/NgobrolApp/8.png",
    ],
    techLogos: ["svg/kotlin.svg", "svg/firebase.svg"],
  },
  {
    id: 14,
    title: "KostHunt",
    description:
      "KostHunt adalah platform pencarian kost yang memudahkan pengguna menemukan tempat tinggal sesuai kebutuhan mereka. Dilengkapi dengan fitur pencarian berbasis lokasi, filter harga dan fasilitas, sistem ulasan pengguna, serta metode pembayaran online melalui Midtrans.",
    category: "web",
    image: "images/kostHuntMern.png",
    link: "https://kost-hunt.vercel.app/",
    techLogos: [
      "https://img.icons8.com/external-tal-revivo-color-tal-revivo/24/external-react-a-javascript-library-for-building-user-interfaces-logo-color-tal-revivo.png",
      "svg/node-js.svg",
      "https://img.icons8.com/color/48/mongo-db.png",
      "svg/javascript.svg",
      "svg/midtrans_logo_white.svg",
      "https://img.icons8.com/color/48/redux.png",
      "https://img.icons8.com/color/48/tailwindcss.png",
      "https://img.icons8.com/dusk/64/xls.png",
    ],
  },
  {
    id: 15,
    title: "Rylix Estate",
    description:
      "Rylix Estate adalah platform pencarian properti berbasis MERN Stack yang memungkinkan pengguna mencari, menyimpan, dan membeli properti dengan mudah. Dilengkapi dengan fitur autentikasi, filter pencarian, manajemen properti, serta pembayaran online melalui Midtrans.",
    category: "web",
    image: "images/RylixEstate.png",
    link: "https://real-estate-mern-sandy.vercel.app/",
    techLogos: [
      "https://img.icons8.com/external-tal-revivo-color-tal-revivo/24/external-react-a-javascript-library-for-building-user-interfaces-logo-color-tal-revivo.png",
      "svg/node-js.svg",
      "https://img.icons8.com/color/48/mongo-db.png",
      "svg/javascript.svg",
      "https://img.icons8.com/color/48/redux.png",
      "https://img.icons8.com/color/48/tailwindcss.png",
    ],
  },
];

// Project Functions
function createProjectElement(project) {
  const flipDirection = project.id % 2 === 0 ? "right" : "left";

  return `
    <div class="col-md-6 col-lg-4 project-item" data-aos="flip-${flipDirection}"
     data-aos-easing="ease-out-cubic"
     data-aos-duration="2000">
      <div class="card project-card h-100" data-project='${JSON.stringify(
        project
      )}'>
        <div class="card-img-wrapper">
          <img src="${project.image}" class="card-img-top" alt="${
    project.title
  }">
          <div class="tech-stack">
            ${project.techLogos
              .map(
                (logo) =>
                  `<img src="${logo}" alt="technology" class="tech-logo">`
              )
              .join("")}
          </div>
        </div>
        <div class="card-body">
          <h5 class="card-title">${project.title}</h5>
          <p class="card-text text-muted">${project.description}</p>
        </div>
      </div>
    </div>
  `;
}

let currentImageIndex = 0;

function updateSliderPosition() {
  const sliderTrack = document.querySelector(".slider-track");
  if (sliderTrack) {
    sliderTrack.style.transform = `translateX(-${currentImageIndex * 100}%)`;
  }
}

function showProjectDialog(project) {
  const dialog = document.getElementById("projectDialog");
  const sliderTrack = dialog.querySelector(".slider-track");

  // Reset slider
  currentImageIndex = 0;
  sliderTrack.innerHTML = "";

  if (project.link) {
    window.open(project.link, "_blank");
    return;
  }
  if (!project.images || project.images.length === 0) {
    alert("Project ini tidak memiliki gambar.");
    return;
  }

  // Tambahkan semua gambar project ke slider
  project.images.forEach((imageSrc) => {
    const img = document.createElement("img");
    img.src = imageSrc;
    img.alt = project.title;
    sliderTrack.appendChild(img);
  });

  updateSliderPosition();
  dialog.style.display = "block";
}

function nextImage() {
  const sliderTrack = document.querySelector(".slider-track");
  const maxIndex = sliderTrack.children.length - 1;
  currentImageIndex = currentImageIndex >= maxIndex ? 0 : currentImageIndex + 1;
  updateSliderPosition();
}

function prevImage() {
  const sliderTrack = document.querySelector(".slider-track");
  const maxIndex = sliderTrack.children.length - 1;
  currentImageIndex = currentImageIndex <= 0 ? maxIndex : currentImageIndex - 1;
  updateSliderPosition();
}

function renderProjects(projects) {
  const container = document.getElementById("project-grid");
  if (!container) return;

  container.innerHTML = "";
  projects.forEach((project) => {
    const element = createProjectElement(project);
    container.insertAdjacentHTML("beforeend", element);
  });
}

function filterProjects(category) {
  const projects =
    category === "all"
      ? projectsDatabase
      : projectsDatabase.filter((project) => project.category === category);

  const container = document.getElementById("project-grid");
  if (!container) return;

  // Fade out existing projects
  const existingProjects = container.querySelectorAll(".project-item");
  existingProjects.forEach((project) => {
    project.style.opacity = "0";
    project.style.transform = "translateY(20px)";
  });

  // Short delay before showing new projects
  setTimeout(() => {
    container.innerHTML = "";
    projects.forEach((project) => {
      const element = createProjectElement(project);
      container.insertAdjacentHTML("beforeend", element);
    });

    // Trigger AOS refresh for new elements
    AOS.refresh();

    // Show new projects with fade in
    const newProjects = container.querySelectorAll(".project-item");
    newProjects.forEach((project) => {
      project.style.opacity = "1";
      project.style.transform = "translateY(0)";
      project.style.transition = "opacity 0.3s ease, transform 0.3s ease";
    });
  }, 300);
}

function initializeFilter() {
  const filterButtons = document.querySelectorAll(".filter-btn");

  filterButtons.forEach((button) => {
    button.addEventListener("click", () => {
      // Remove active class from all buttons
      filterButtons.forEach((btn) => btn.classList.remove("active"));
      // Add active class to clicked button
      button.classList.add("active");
      // Filter projects
      filterProjects(button.getAttribute("data-filter"));
    });
  });
}

// Smooth Scrolling
document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
  anchor.addEventListener("click", function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute("href"));
    if (target) {
      const headerOffset = 80;
      const elementPosition = target.getBoundingClientRect().top;
      const offsetPosition =
        elementPosition + window.pageYOffset - headerOffset;

      window.scrollTo({
        top: offsetPosition,
        behavior: "smooth",
      });
    }
  });
});

// Navbar Scroll Effect
function handleScroll() {
  const navbar = document.querySelector(".navbar");
  if (window.scrollY > 50) {
    navbar.classList.add("navbar-scrolled");
  } else {
    navbar.classList.remove("navbar-scrolled");
  }
}

// Initialize AOS
AOS.init({
  duration: 1000,
  once: true,
  offset: 100,
});

// Initialize Typed.js
document.addEventListener("DOMContentLoaded", function () {
  const typed = new Typed("#typed-text", {
    strings: [
      "Android Developer",
      "Web Developer",
      "UI/UX Designer",
      "Mobile Developer",
    ],
    typeSpeed: 50,
    backSpeed: 30,
    loop: true,
    showCursor: true,
    cursorChar: "|",
    autoInsertCss: true,
    backDelay: 1500,
    startDelay: 100,
  });

  const dialog = document.getElementById("projectDialog");
  const closeBtn = dialog.querySelector(".close-btn");
  const prevBtn = dialog.querySelector(".prev-btn");
  const nextBtn = dialog.querySelector(".next-btn");

  document.addEventListener("click", (e) => {
    const projectCard = e.target.closest(".project-card");
    if (projectCard) {
      const projectData = JSON.parse(projectCard.dataset.project);
      showProjectDialog(projectData);
    } else {
    }
  });

  closeBtn.addEventListener("click", () => {
    dialog.style.display = "none";
  });

  prevBtn.addEventListener("click", prevImage);
  nextBtn.addEventListener("click", nextImage);

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && dialog.style.display === "block") {
      dialog.style.display = "none";
    }
  });
  gsap.registerPlugin(ScrollTrigger);
  ScrollTrigger.refresh();

  gsap.from(".experience-badge", {
    scrollTrigger: {
      trigger: ".experience-badge",
    },
    x: 500,
    ease: "bounce",
    duration: 2,
  });

  gsap.from(".year", {
    scrollTrigger: {
      trigger: ".year",
    },
    opacity: 0,
    duration: 2,
  });

  gsap.from(".navbar", {
    y: "-100%",
    opacity: 0,
    duration: 1.5,
  });

  gsap.from(".skill-left", {
    scrollTrigger: {
      trigger: ".skill-left",
    },
    x: -500,
    ease: "bounce",
    duration: 2,
  });

  gsap.from(".skill-right", {
    scrollTrigger: {
      trigger: ".skill-right",
    },
    x: 500,
    ease: "bounce",
    duration: 2,
  });

  renderProjects(projectsDatabase);
  initializeFilter();
  window.addEventListener("scroll", handleScroll);
});
